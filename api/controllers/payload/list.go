
package payload

import (
															"github.com/gin-gonic/gin"
															"net/http"
	http_error_controller 			"pentest-tools/api/controllers/error/http"
	payload_model 							"pentest-tools/api/models/payload"
)

func List(c *gin.Context) {

	payload_type := c.Param("payload_type")

	valid_payload_type, err := payload_model.ValidType(payload_type)
	if valid_payload_type == false { http_error_controller.Return400(c) }

	payload_list, err := payload_model.List(payload_type)
	if err != nil { http_error_controller.Return500(c) }

	c.IndentedJSON(http.StatusOK, payload_list)

}
