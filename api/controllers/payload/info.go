
package payload

import (
                              "github.com/gin-gonic/gin"
                              "net/http"
  http_error_controller       "pentest-tools/api/controllers/error/http"
  payload_model               "pentest-tools/api/models/payload"
)

func Info(c *gin.Context) {
  
  payload_type        := c.Param("payload_type")
  payload_identifier  := c.Param("payload_identifier")

  valid_payload_type, err := payload_model.ValidType(payload_type)
  if valid_payload_type == false { http_error_controller.Return400(c) }

  valid_payload_identifier, err := payload_model.ValidIdentifier(payload_identifier)
  if valid_payload_identifier == false { http_error_controller.Return400(c) }

  payload, err := payload_model.Info(payload_type, payload_identifier)
  if err != nil { http_error_controller.Return500(c) }

  c.IndentedJSON(http.StatusOK, payload)

}
