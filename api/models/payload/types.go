
package payload

import (
  "os"
  "regexp"
  "sort"
)

func Types() (payload_types []string, err error) {

  payloads_file, err := os.Open("../data/payloads")
  if err != nil { return payload_types, err }

  payload_filenames, err := payloads_file.Readdirnames(0)
  if err != nil { return payload_types, err }

  defer payloads_file.Close()

  regex := regexp.MustCompile("^[A-Za-z0-9_-]{1,100}")
  
  for _, payload_filename := range payload_filenames {

    payload_type := regex.FindString(payload_filename)

    if payload_type != "" {
      payload_types = append(payload_types, payload_type)
    } else {
      continue
    }

  }

  sort.Strings(payload_types)

  return payload_types, err

}
